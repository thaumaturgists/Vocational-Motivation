# TouchUP to 'quiz-app'

The provided Docker setup is for a quiz application that consists of a frontend built with React and Vite, and a backend (presumably) built with Flask, as indicated in the `docker-compose.yml` file. The frontend is built in a multi-stage Dockerfile, which is a common practice to optimize the image size and separate the build environment from the production environment.

### Breakdown of the Dockerfile

1. **Multi-Stage Build**:
   - The Dockerfile uses a multi-stage build approach. The first stage (`build`) uses a Node.js image to build the React application. This stage installs dependencies, copies the application code, and runs the build command to generate static files.
   - The second stage uses an Nginx image to serve the built static files. This separation helps keep the final image lightweight by excluding development dependencies and build tools.

2. **Nginx**:
   - Nginx is used in the second stage to serve the static files generated by the React application. Hereâ€™s why Nginx is a suitable choice:
     - **Static File Serving**: Nginx is highly efficient at serving static files, which is what the built React application consists of (HTML, CSS, JavaScript).
     - **Performance**: Nginx is designed to handle a large number of concurrent connections, making it ideal for serving web applications.
     - **Reverse Proxy**: If the application needs to communicate with a backend service (like a Flask API), Nginx can be configured as a reverse proxy, routing requests to the appropriate service.
     - **Load Balancing**: Nginx can also be used to load balance requests across multiple instances of the backend service if needed.

3. **Docker Compose**:
   - The `docker-compose.yml` file defines two services: `backend` and `frontend`.
   - The `frontend` service builds the React application using the Dockerfile provided and maps port 80 of the container to port 80 on the host, allowing access to the application via a web browser.
   - The `backend` service is set up to run a Flask application (as inferred from the environment variable), mapping port 5000 of the container to port 5000 on the host.

### Why Nginx is Needed

- **Serving Static Content**: The React app is built into static files that need to be served to users. Nginx is optimized for this purpose.
- **Handling Requests**: If the frontend needs to make API calls to the backend, Nginx can manage these requests efficiently.
- **Security and Configuration**: Nginx can provide additional layers of security, such as SSL termination, and can be configured to handle various routing and caching strategies.

### Summary

In summary, the use of Nginx in this Docker setup is crucial for efficiently serving the static files generated by the React application, managing requests to the backend, and providing a robust and performant web server environment. The multi-stage build process ensures that the final image is optimized for production, containing only the necessary files and dependencies.

quiz-app/dockerfile:
```dockerfile
# Stage 1: Build the application
FROM node:lts-slim@sha256:157c7ea6f8c30b630d6f0d892c4f961eab9f878e88f43dd1c00514f95ceded8a AS build

# Set the working directory
WORKDIR /usr/src/app

# Copy package.json and package-lock.json (if available)
COPY package*.json ./

# Install dependencies
RUN npm install

# Copy the rest of the application code
COPY . .

# Build the application
RUN npm run build

# Stage 2: Serve the application with Nginx
FROM nginx:alpine

# Copy built files from the previous stage
COPY --from=build /usr/src/app/dist /usr/share/nginx/html

# Expose the port (Nginx default port)
EXPOSE 80

# Command to run Nginx
CMD ["nginx", "-g", "daemon off;"]
```
quiz-app/package.json:
```json
{
  "name": "quiz-app",
  "version": "1.0.0",
  "main": "main.tsx",
  "scripts": {
    "dev": "vite",
    "start": "vite preview",
    "build": "vite build"
  },
  "dependencies": {
    "react": "^19.1.0",
    "react-dom": "^19.1.0"
  },
  "devDependencies": {
    "@types/react": "^19.1.2",
    "@types/react-dom": "^19.1.2",
    "@vitejs/plugin-react": "^4.4.1",
    "typescript": "^5.8.3",
    "vite": "^6.3.3"
  }
}
```
quiz-app/vite.config.ts:
```ts
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [react()],
  publicDir: 'public',
  server: {
    host: '0.0.0.0',
    port: 80,
  },
  build: {
    outDir: 'dist', // Output directory for the build
  },
});
```

```yml
services:
  backend:
    build:
      context: ./creation-profile-cards
      dockerfile: dockerfile
    ports:
      - "5000:5000"  # Map the backend port
    volumes:
      - ./creation-profile-cards:/usr/src/app  # Optional: for live reloading
    environment:
      - FLASK_ENV=development  # Adjust if using Flask or similar
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "5"

  frontend:
    build:
      context: ./quiz-app
      dockerfile: dockerfile
    ports:
      - "80:80"  # Map the Vite development server port
    volumes:
      - ./quiz-app:/usr/src/app
    environment:
      - NODE_ENV=development
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "5"
```